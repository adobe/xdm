{
  "meta:license": [
    "Copyright 2018 Adobe Systems Incorporated. All rights reserved.",
    "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
    "you may not use this file except in compliance with the License. You may obtain a copy",
    "of the License at https://creativecommons.org/licenses/by/4.0/"
  ],
  "$schema": "http://json-schema.org/draft-06/schema#",
  "$id": "https://ns.adobe.com/experience/offer-management/eligibility-rule",
  "meta:abstract": false,
  "meta:extensible": true,
  "type": "object",
  "title": "Eligibility Rule",
  "description":
    "An EligibilityRule is a named reusable predicate used in the domain of audience segmentation and message personalization. The Profile Query Language forms the foundation of those predicates. The prodicate operates not only over profile fields but also over contextual data objects provided at the time of decisioning.",
  "definitions": {
    "eligibility-rule": {
      "properties": {
        "@id": {
          "type": "string",
          "format": "uri-reference",
          "title": "ID",
          "description":
            "The unique identifier of the EligibilityRule. This identifier is assigned by clients or services that use the repository and is not generated by the repository itself. This @id must be unique within a repository container for objects that are not the same, otherwise it is interpreted as referring to the same object. The @id is used in link relationships. For example an Offer's selection constraint object references an EligibilityRule object."
        },
        "xdm:name": {
          "type": "string",
          "title": "Name",
          "description":
            "EligibilityRule name that is used to locate this object in a search operation"
        },
        "xdm:value": {
          "type": "object",
          "title": "Expression over XDM instances",
          "description":
            "Contains the expression over a collection of context XDM instances. When the expression evaluates to true the offer refering to this eligibility rule will be included in the decisioning otherwise included. Central context instances include the profile and the experience events associtaed with the profile.",
          "$ref":
            "https://ns.adobe.com/experience/offer-management/filter-expression"
        },
        "xdm:modelUsage": {
          "title": "Used Properties",
          "description":
            "An list of Model Usage objects, one per model, that lists the fully qualified path to every used property from the model.",
          "type": "array",
          "items": {
            "$ref":
              "https://ns.adobe.com/experience/offer-management/model-usage"
          }
        }
      },
      "required": ["xdm:name", "xdm:value", "xdm:modelUsage"]
    }
  },
  "allOf": [
    {
      "$ref": "#/definitions/eligibility-rule"
    }
  ]
}
