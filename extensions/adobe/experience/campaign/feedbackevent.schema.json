{
  "meta:license": [
    "Copyright 2018 Adobe Systems Incorporated. All rights reserved.",
    "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
    "you may not use this file except in compliance with the License. You may obtain a copy",
    "of the License at https://creativecommons.org/licenses/by/4.0/"
  ],
  "$id": "https://ns.adobe.com/experience/campaign/feedbackevent",
  "$schema": "http://json-schema.org/draft-06/schema#",
  "title": "Adobe Delivery Feedback Events",
  "type": "object",
  "meta:extensible": true,
  "meta:intendedToExtend": ["https://ns.adobe.com/xdm/context/experienceevent"],
  "description": "Contains all delivery event fields.",
  "definitions": {
    "feedbackevent": {
      "properties": {
        "xdm:feedbackType": {
          "title": "Type",
          "type": "string",
          "description": "The type of message event"
        },
        "xdm:retryCount": {
          "title": "retryCount",
          "type": "integer",
          "description": "Number of failed attempts before the current event"
        },
        "https://ns.adobe.com/experience/campaign/delivery": {
          "title": "The campaign activity originating a message to a recipient.",
          "type": "object",
          "properties": {
            "xdm:id": {
              "title": "Delivery ID",
              "type": "string",
              "description": "The campaign activity originating this message."
            },
            "xdm:campaignId": {
              "title": "Campaign Id",
              "type": "string",
              "description": "Campaign of which this delivery was a part."
            },
            "xdm:from": {
              "title": "From",
              "type": "string",
              "description": "Address used as a from/sender/caller address. Depending on the communication channel, the `address` has a different format.\n\n  * `email`: an email address.\n  * `textMessage` or `phone`: a shortcode or phone number."
            },
            "xdm:type": {
              "title": "Delivery Type",
              "type": "string",
              "description": "Mode of delivery for the messages sent."
            },
            "xdm:deliveryLabel": {
              "title": "Delivery Label",
              "type": "string",
              "description": "A human-friendly name of the campaign activity which is originating this message."
            },
            "xdm:deliveryName": {
              "title": "Delivery Internal Name",
              "type": "string",
              "description": "A human-friendly identifier of the campaign activity which is originating this message."
            }
          }
        },
        "https://ns.adobe.com/experience/campaign/message": {
          "title": "A single message sent to a recipient.",
          "type": "object",
          "properties": {
            "xdm:id": {
              "title": "Message Identifier",
              "type": "number",
              "description": "Identifier of the message."
            },
            "xdm:subject": {
              "title": "Message Subject",
              "type": "string",
              "description": "Subject line of the message."
            },
            "xdm:size": {
              "title": "Size (Bytes)",
              "type": "integer",
              "description": "Size in bytes of the message.\n* For email, the `size` reflects the all MIME envelope of the message, including the encoded attachments if any.\n* For SMS, the `size` reflects the number of bytes necessary to deliver the message.\nIf that number is over 160 the message will be delivered over more than one SMS.",
              "minimum": 0,
              "maximum": 2147483647
            },
            "https://ns.adobe.com/experience/campaign/recipient": {
              "title": "The recipient of this message",
              "type": "object",
              "properties": {
                "to": {
                  "title": "To",
                  "type": "string",
                  "description": "Address used as a to/callee address. Depending on the communication channel, the `address` has a different format.\n\n  * `email`: an email address.\n  * `textMessage` or `phone`: a shortcode or phone number."
                },
                "xdm:Type": {
                  "title": "Type",
                  "type": "string",
                  "description": "Whether this message message event describes the BCC, CC or To recipient"
                }
              }
            }
          }
        },
        "https://ns.adobe.com/experience/campaign/messageFailure": {
          "xdm:canonicalReason": {
            "title": "Reason",
            "type": "string",
            "description": "Canonicalized text of the response returned by the remote server due to a failed delivery attempt."
          },
          "xdm:reason": {
            "title": "Reason",
            "type": "string",
            "description": "Unmodified, exact response returned by the remote server due to a failed delivery attempt."
          },
          "xdm:errorCode": {
            "title": "Error Code",
            "type": "string",
            "description": "Error code by which the remote server described a failed delivery attempt."
          },
          "xdm:bounceType": {
            "title": "Bounce Type",
            "type": "string",
            "description": "Classifies whether it is a soft bounce or hard bounce"
          },
          "xdm:bounceClass": {
            "title": "Bounce Class",
            "type": "string",
            "description": "Classification code for a given message"
          }
        },
        "xdm:solutionContext": {
          "title": "Solution Context",
          "type": "object",
          "description": "Solution specific data",
          "$ref": "https://ns.adobe.com/experience/analytics/keyedlist"
        },
        "https://ns.adobe.com/experience/campaign/channel": {
          "xdm:channelType": {
            "title": "Channel Type",
            "type": "string",
            "description": "Classifies whether the channel is email, push, sms"
          },
          "https://ns.adobe.com/experience/campaign/email": {
            "https://ns.adobe.com/experience/campaign/interactions": {
              "title": "User interations",
              "type": "object",
              "properties": {
                "xdm:fbType": {
                  "title": "FB Type",
                  "type": "string",
                  "description": "Type of spam report entered against this message (see RFC 5965 ยง 7.3)."
                },
                "xdm:reportBy": {
                  "title": "Report By",
                  "type": "string",
                  "description": "E-mail Address of the entity reporting this message as spam."
                },
                "xdm:reportTo": {
                  "title": "Report To",
                  "type": "string",
                  "description": "E-mail Address to which this spam report is to be delivered"
                },
                "xdm:userAgent": {
                  "title": "User Agent",
                  "type": "string",
                  "description": "Value of the browser's User-Agent header"
                }
              }
            },
            "https://ns.adobe.com/experience/campaign/operationalContext": {
              "title": "Operational Context",
              "type": "object",
              "properties": {
                "xdm:outboundIP": {
                  "title": "IP Address",
                  "type": "string",
                  "description": "Outbound IP address of the customer used to deliver the message."
                },
                "xdm:deliveryMethod": {
                  "title": "Delivery Method",
                  "type": "string",
                  "description": "Protocol by which the message is delivered."
                },
                "xdm:remoteIp": {
                  "title": "IP Address",
                  "type": "string",
                  "oneOf": [
                    {
                      "format": "ipv4"
                    },
                    {
                      "format": "ipv6"
                    }
                  ],
                  "description": "IP address of the host to which this message is delivered."
                },
                "xdm:mtaHost": {
                  "title": "Node Name",
                  "type": "string",
                  "description": "Name of the MTA Instance originating the events."
                },
                "xdm:mtaIp": {
                  "title": "Sending IP Address",
                  "type": "string",
                  "oneOf": [
                    {
                      "format": "ipv4"
                    },
                    {
                      "format": "ipv6"
                    }
                  ],
                  "description": "IP address through which this message was sent."
                },
                "xdm:queueTime": {
                  "title": "Queue time",
                  "type": "timestamp",
                  "description": "Delay, expressed in milliseconds, between this message's injection into SparkPost and its delivery to the receiving domain; that is, the length of time this message spent in the outgoing queue."
                }
              }
            }
          }
        }
      }
    }
  },
  "allOf": [
    {
      "$ref": "#/definitions/feedbackevent"
    }
  ],
  "meta:status": "experimental"
}
