{
  "meta:license": [
    "Copyright 2026 Adobe Systems Incorporated. All rights reserved.",
    "This work is licensed under a Creative Commons Attribution 4.0 International (CC BY 4.0) license",
    "you may not use this file except in compliance with the License. You may obtain a copy",
    "of the License at https://creativecommons.org/licenses/by/4.0/"
  ],
  "$id": "https://ns.adobe.com/xdm/fieldgroups/aoAgentsEventFields",
  "$schema": "http://json-schema.org/draft-06/schema#",
  "title": "AO Events Fields",
  "type": "object",
  "description": "AO Events Fields",
  "meta:intendedToExtend": ["https://ns.adobe.com/xdm/context/experienceevent"],
  "definitions": {
    "aoAgentsEventFields": {
      "properties": {
        "aoEventFields": {
          "type": "object",
          "title": "AO Events Fields",
          "description": "AO Events Fields",
          "properties": {
            "eventname": {
              "type": "string",
              "description": "Event name following pattern {namespace}.{component}.{event_name}",
              "meta:xdmType": "string"
            },
            "attributes": {
              "type": "object",
              "description": "Key-value pairs providing event context",
              "required": [
                "ims_org_id",
                "ao_conversation_id",
                "ao_interaction_id"
              ],
              "properties": {
                "ims_org_id": {
                  "type": "string",
                  "description": "Adobe IMS organization identifier",
                  "meta:xdmType": "string"
                },
                "ims_user_id": {
                  "type": "string",
                  "description": "Adobe IMS user identifier",
                  "meta:xdmType": "string"
                },
                "sandbox_name": {
                  "type": "string",
                  "description": "AEP Sandbox name",
                  "meta:xdmType": "string"
                },
                "sandbox_id": {
                  "type": "string",
                  "description": "AEP Sandbox identifier",
                  "meta:xdmType": "string"
                },
                "ao_manifest_id": {
                  "type": "string",
                  "description": "Agent manifest identifier (e.g., aiassistant_p1_manifest)",
                  "meta:xdmType": "string"
                },
                "ao_conversation_id": {
                  "type": "string",
                  "description": "Unique conversation identifier",
                  "meta:xdmType": "string"
                },
                "ao_interaction_id": {
                  "type": "string",
                  "description": "Unique interaction identifier within conversation",
                  "meta:xdmType": "string"
                },
                "ao_schema_version": {
                  "type": "string",
                  "description": "Event schema version following semantic versioning (e.g., '1.0.0'). Indicates which schema version this event conforms to.",
                  "meta:xdmType": "string"
                },
                "ao_app_application": {
                  "type": "string",
                  "description": "Application identifier (e.g., CJA, AEP)",
                  "meta:xdmType": "string"
                },
                "ao_app_upstream_client": {
                  "type": "string",
                  "description": "Upstream client from which the user has done the request (e.g., next gen-ui, ms-copilot)",
                  "meta:xdmType": "string"
                },
                "ao_app_user_surface": {
                  "type": "string",
                  "description": "Surface from which the user has made the request (e.g., teams, powerpoint)",
                  "meta:xdmType": "string"
                },
                "ao_customer_data_usage": {
                  "type": "string",
                  "description": "Whether usage is primary or secondary",
                  "enum": ["primary", "secondary"],
                  "meta:enum": {
                    "primary": "Primary",
                    "secondary": "Secondary"
                  },
                  "meta:xdmType": "string"
                }
              },
              "meta:xdmType": "object"
            },
            "body": {
              "type": "object",
              "description": "Event-specific payload containing detailed information based on event type",
              "properties": {
                "agent_version": {
                  "type": "string",
                  "description": "Version of the agent (for agent invocation/response/error events)",
                  "meta:xdmType": "string"
                },
                "error_type": {
                  "type": "string",
                  "description": "Exception class name (for error events)",
                  "meta:xdmType": "string"
                },
                "agent_names": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "meta:xdmType": "string"
                  },
                  "description": "Names of agents included in plan (for plan events)",
                  "meta:xdmType": "array"
                },
                "agents": {
                  "type": "array",
                  "description": "List of agents called during interaction with call counts (for interaction.end event)",
                  "items": {
                    "type": "object",
                    "required": ["agent_name", "call_count"],
                    "properties": {
                      "agent_name": {
                        "type": "string",
                        "description": "Name of the agent that was called",
                        "meta:xdmType": "string"
                      },
                      "agent_version": {
                        "type": "string",
                        "description": "Version string of the agent (optional)",
                        "meta:xdmType": "string"
                      },
                      "call_count": {
                        "type": "integer",
                        "description": "Number of times this agent was called",
                        "minimum": 0,
                        "maximum": 2147483647,
                        "meta:xdmType": "int"
                      }
                    },
                    "additionalProperties": false,
                    "meta:xdmType": "object"
                  },
                  "meta:xdmType": "array"
                },
                "feedback_type": {
                  "type": "string",
                  "description": "Feedback type (e.g., interaction feedback, in the future perhaps llm-generated info on conversation quality) (for feedback event)",
                  "examples": ["InteractionFeedback"],
                  "meta:xdmType": "string"
                }
              },
              "meta:xdmType": "object"
            }
          },
          "required": ["eventname", "attributes"],
          "meta:xdmType": "object"
        }
      }
    }
  },
  "allOf": [
    {
      "$ref": "#/definitions/aoAgentsEventFields"
    }
  ],
  "meta:status": "experimental"
}
